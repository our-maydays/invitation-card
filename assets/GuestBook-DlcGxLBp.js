import{h as J,r as h,j as n,M as ee}from"./index-D8CWS27m.js";import{S as B}from"./Space-CGviTS4q.js";import"./ko-1x67wy2p.js";import{b as Ce,c as X,g as be}from"./react-Bce9NwRC.js";import{g as oe,q as ae,l as Se,o as le,c as Z,u as _e,d as ce,a as z,b as $e,e as Be}from"./firebase-BaVMvK3H.js";var V={exports:{}};function He(j){throw new Error('Could not dynamically require "'+j+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var G={exports:{}};const Ie={},ke=Object.freeze(Object.defineProperty({__proto__:null,default:Ie},Symbol.toStringTag,{value:"Module"})),Re=Ce(ke);var De=G.exports,de;function Ne(){return de||(de=1,(function(j,O){(function(C,m){j.exports=m()})(De,function(){var C=C||(function(m,S){var d;if(typeof window<"u"&&window.crypto&&(d=window.crypto),typeof self<"u"&&self.crypto&&(d=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(d=globalThis.crypto),!d&&typeof window<"u"&&window.msCrypto&&(d=window.msCrypto),!d&&typeof X<"u"&&X.crypto&&(d=X.crypto),!d&&typeof He=="function")try{d=Re}catch{}var E=function(){if(d){if(typeof d.getRandomValues=="function")try{return d.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof d.randomBytes=="function")try{return d.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},k=Object.create||(function(){function e(){}return function(t){var s;return e.prototype=t,s=new e,e.prototype=null,s}})(),w={},_=w.lib={},$=_.Base=(function(){return{extend:function(e){var t=k(this);return e&&t.mixIn(e),(!t.hasOwnProperty("init")||this.init===t.init)&&(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}})(),g=_.WordArray=$.extend({init:function(e,t){e=this.words=e||[],t!=S?this.sigBytes=t:this.sigBytes=e.length*4},toString:function(e){return(e||v).stringify(this)},concat:function(e){var t=this.words,s=e.words,o=this.sigBytes,l=e.sigBytes;if(this.clamp(),o%4)for(var c=0;c<l;c++){var u=s[c>>>2]>>>24-c%4*8&255;t[o+c>>>2]|=u<<24-(o+c)%4*8}else for(var f=0;f<l;f+=4)t[o+f>>>2]=s[f>>>2];return this.sigBytes+=l,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=m.ceil(t/4)},clone:function(){var e=$.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],s=0;s<e;s+=4)t.push(E());return new g.init(t,e)}}),b=w.enc={},v=b.Hex={stringify:function(e){for(var t=e.words,s=e.sigBytes,o=[],l=0;l<s;l++){var c=t[l>>>2]>>>24-l%4*8&255;o.push((c>>>4).toString(16)),o.push((c&15).toString(16))}return o.join("")},parse:function(e){for(var t=e.length,s=[],o=0;o<t;o+=2)s[o>>>3]|=parseInt(e.substr(o,2),16)<<24-o%8*4;return new g.init(s,t/2)}},y=b.Latin1={stringify:function(e){for(var t=e.words,s=e.sigBytes,o=[],l=0;l<s;l++){var c=t[l>>>2]>>>24-l%4*8&255;o.push(String.fromCharCode(c))}return o.join("")},parse:function(e){for(var t=e.length,s=[],o=0;o<t;o++)s[o>>>2]|=(e.charCodeAt(o)&255)<<24-o%4*8;return new g.init(s,t)}},i=b.Utf8={stringify:function(e){try{return decodeURIComponent(escape(y.stringify(e)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(e){return y.parse(unescape(encodeURIComponent(e)))}},a=_.BufferedBlockAlgorithm=$.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(e){typeof e=="string"&&(e=i.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t,s=this._data,o=s.words,l=s.sigBytes,c=this.blockSize,u=c*4,f=l/u;e?f=m.ceil(f):f=m.max((f|0)-this._minBufferSize,0);var D=f*c,H=m.min(D*4,l);if(D){for(var I=0;I<D;I+=c)this._doProcessBlock(o,I);t=o.splice(0,D),s.sigBytes-=H}return new g.init(t,H)},clone:function(){var e=$.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});_.Hasher=a.extend({cfg:$.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){a.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,s){return new e.init(s).finalize(t)}},_createHmacHelper:function(e){return function(t,s){return new p.HMAC.init(e,s).finalize(t)}}});var p=w.algo={};return w})(Math);return C})})(G)),G.exports}var Ee=V.exports,he;function Ae(){return he||(he=1,(function(j,O){(function(C,m){j.exports=m(Ne())})(Ee,function(C){return(function(m){var S=C,d=S.lib,E=d.WordArray,k=d.Hasher,w=S.algo,_=[],$=[];(function(){function v(p){for(var e=m.sqrt(p),t=2;t<=e;t++)if(!(p%t))return!1;return!0}function y(p){return(p-(p|0))*4294967296|0}for(var i=2,a=0;a<64;)v(i)&&(a<8&&(_[a]=y(m.pow(i,1/2))),$[a]=y(m.pow(i,1/3)),a++),i++})();var g=[],b=w.SHA256=k.extend({_doReset:function(){this._hash=new E.init(_.slice(0))},_doProcessBlock:function(v,y){for(var i=this._hash.words,a=i[0],p=i[1],e=i[2],t=i[3],s=i[4],o=i[5],l=i[6],c=i[7],u=0;u<64;u++){if(u<16)g[u]=v[y+u]|0;else{var f=g[u-15],D=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,H=g[u-2],I=(H<<15|H>>>17)^(H<<13|H>>>19)^H>>>10;g[u]=D+g[u-7]+I+g[u-16]}var te=s&o^~s&l,ne=a&p^a&e^p&e,A=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),K=(s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25),W=c+K+te+$[u]+g[u],Q=A+ne;c=l,l=o,o=s,s=t+W|0,t=e,e=p,p=a,a=W+Q|0}i[0]=i[0]+a|0,i[1]=i[1]+p|0,i[2]=i[2]+e|0,i[3]=i[3]+t|0,i[4]=i[4]+s|0,i[5]=i[5]+o|0,i[6]=i[6]+l|0,i[7]=i[7]+c|0},_doFinalize:function(){var v=this._data,y=v.words,i=this._nDataBytes*8,a=v.sigBytes*8;return y[a>>>5]|=128<<24-a%32,y[(a+64>>>9<<4)+14]=m.floor(i/4294967296),y[(a+64>>>9<<4)+15]=i,v.sigBytes=y.length*4,this._process(),this._hash},clone:function(){var v=k.clone.call(this);return v._hash=this._hash.clone(),v}});S.SHA256=k._createHelper(b),S.HmacSHA256=k._createHmacHelper(b)})(Math),C.SHA256})})(V)),V.exports}var Oe=Ae();const qe=be(Oe),ze="/invitation-card//icon/check.svg",ue="/invitation-card//icon/close_icon.svg",fe=6,Y=3,Pe=3,P=5,x=4,N=1.5,L=18,M=P+Pe+N+L+N+x+Y;ee.setAppElement("#root");const me=j=>qe(j).toString(),Me=()=>{J.locale("ko");const[j,O]=h.useState(""),[C,m]=h.useState(""),[S,d]=h.useState(""),[E,k]=h.useState([]),[w,_]=h.useState(null),[$,g]=h.useState(!1),[b,v]=h.useState(null),[y,i]=h.useState(""),[a,p]=h.useState(!1),[e,t]=h.useState(""),[s,o]=h.useState(""),[l,c]=h.useState(!1),[u,f]=h.useState(!1),[D,H]=h.useState(!1),I=h.useRef(null),[te,ne]=h.useState(!1);h.useRef(null);const A=async r=>{g(!0);const R=await oe(ae(Z(z,"comment"),le("createdAt","desc"),Se(r)));_(R),g(!1)};h.useEffect(()=>{A(10)},[]);const K=()=>{if(!$){const r=w.docs.length+5;A(r)}},W=async()=>{const r=new Date,R=j.trim().length>0,F=C.trim().length>0,U=S.trim().length>0,q=[];if(R||q.push("이름"),U||q.push("비밀번호"),F||q.push("메세지"),q.length>0)alert(`${q.join(", ")} 항목을 입력해주세요`);else{const ie=me(S);await Be(Z(z,"comment"),{name:j,content:C,passwordHash:ie,createdAt:r});const we={id:E.length,name:j,content:C,passwordHash:ie,createdAt:r};k([...E,we]);const je=await oe(ae(Z(z,"comment"),le("createdAt","desc")));_(je),O(""),m(""),d(""),c(!1)}},Q=()=>{me(y)===b.passwordHash?p(!0):alert("비밀번호가 일치하지 않습니다")},ge=async()=>{await _e(ce(z,"comment",b.id),{content:e,name:s}),T(),A(w.docs.length)},pe=async()=>{await $e(ce(z,"comment",b.id)),T(),A(w.docs.length)},se=()=>{O(""),m(""),d(""),c(!1)},T=()=>{v(null),i(""),p(!1),f(!1)},ve=r=>{O(r.target.value)},ye=r=>{m(r.target.value)},xe=r=>{const R=r.target.value.replace(/[^0-9]/g,"");d(R)};h.useEffect(()=>(l?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[l]),h.useEffect(()=>(u?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[u]),h.useEffect(()=>{const r=I.current;if(r)return r.addEventListener("scroll",re),()=>{r.removeEventListener("scroll",re)}},[w]);const re=()=>{const r=I.current;if(!r)return;const R=r.scrollTop,F=r.clientHeight,U=r.scrollHeight;-R+F>=U-50&&(console.log(r.scrollBottom),console.log(R),console.log(F),console.log(U),K())};return n.jsxs("div",{className:"content-box",style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[n.jsx(B,{height:`${fe}rem`}),n.jsx("div",{className:"section-subtitle",children:"GUEST BOOK"}),n.jsx("div",{className:"section-title",children:"방명록"}),n.jsx(B,{height:`${Y}rem`}),n.jsx("div",{className:"guestbook",children:n.jsx("div",{ref:I,style:{display:"flex",flexDirection:"column-reverse",overflowY:"scroll",width:"100%",height:"349px"},children:w&&[...w.docs].map(r=>n.jsxs("div",{onClick:()=>{v({id:r.id,...r.data()}),t(r.data().content),o(r.data().name),f(!0)},children:[n.jsxs("div",{className:"nameOutput",children:[" ",r.data().name," "]}),n.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-end"},children:[n.jsxs("div",{className:"messageOutput",children:[" ",r.data().content," "]}),n.jsxs("div",{className:"dateOutput",children:[J(r.data().createdAt.toDate()).format("YY.MM.DD"),n.jsx("br",{}),J(r.data().createdAt.toDate()).format("a h:mm")]})]})]},r.id))})}),n.jsx(B,{height:`${Y/2}rem`}),n.jsx("div",{className:"button",onClick:()=>c(!0),style:{width:"90%",paddingLeft:0,paddingRight:0},children:"축하메세지 보내기"}),n.jsx(B,{height:`${fe}rem`}),b&&n.jsx(ee,{isOpen:u,onRequestClose:T,preventScroll:!0,style:{overlay:{backgroundColor:"#D2D7D9CC",zIndex:"1000"},content:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",background:"#F8F7EE",width:"95%",maxWidth:"390px",height:`${M}rem`,border:"none",borderRadius:"1rem",margin:0,padding:0}},children:n.jsxs("div",{style:{height:"100%"},children:[n.jsx("div",{style:{display:"flex",justifyContent:"right",height:`${P}rem`,margin:0,padding:0},children:n.jsx("div",{onClick:T,style:{display:"flex",justifyContent:"center",alignItems:"center",background:"transparent",fontSize:"1.6rem",border:"none",cursor:"pointer",marginRight:"1rem"},children:n.jsx("img",{src:ue,style:{height:"3rem"}})})}),n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",height:`${M-P}rem`},children:a?n.jsxs("div",{style:{width:"100%",height:`${M-P}rem`},children:[n.jsx("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center",marginLeft:"1rem",marginRight:"1rem",height:`${x}rem`},children:n.jsx("textarea",{className:"nameInput",placeholder:"이름",onChange:r=>o(r.target.value),value:s,style:{height:`${x}rem`,width:"50%",lineHeight:`${x-1}rem`}})}),n.jsx(B,{height:`${N}rem`}),n.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",height:`${L}rem`,marginLeft:"1rem",marginRight:"1rem"},children:n.jsx("textarea",{className:"messageInput",placeholder:"메세지",onChange:r=>t(r.target.value),value:e,autoComplete:"new-password",style:{height:`${L-1}rem`}})}),n.jsx(B,{height:`${N}rem`}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"1rem",width:"95%",height:`${x}rem`,margin:"auto"},children:[n.jsx("div",{className:"button",onClick:ge,style:{width:"18rem"},children:"수정"}),n.jsx("div",{className:"button",onClick:pe,style:{width:"18rem"},children:"삭제"})]}),n.jsx(B,{height:`${N}rem`})]}):n.jsxs("div",{style:{width:"80%",display:"flex",alignItems:"center",justifyContents:"center",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},children:[n.jsx("div",{style:{position:"relative",display:"flex",alignItems:"center",height:`${x}rem`,marginRight:"1rem"},children:n.jsx("textarea",{className:"passwordInput",type:"password",placeholder:"비밀번호(숫자만 입력 가능)",onChange:r=>i(r.target.value.replace(/[^0-9]/g,"")),value:y,style:{height:`${x}rem`,lineHeight:`${x-1}rem`}})}),n.jsx("div",{className:"button",onClick:Q,style:{width:"6rem",height:`${x}rem`},children:n.jsx("img",{src:ze,className:"icon"})})]})})]})}),n.jsx(ee,{isOpen:l,onRequestClose:se,style:{overlay:{backgroundColor:"#D2D7D9CC",zIndex:"1000"},content:{top:"50%",left:"50%",transform:"translate(-50%,-50%)",background:"#F8F7EE",width:"95%",maxWidth:"390px",height:`${M}rem`,border:"none",margin:"0",padding:"0",borderRadius:"1.5rem"}},children:n.jsxs("div",{style:{height:"100%"},children:[n.jsx("div",{style:{display:"flex",justifyContent:"right",height:`${P}rem`},children:n.jsx("div",{onClick:se,style:{display:"flex",alingItems:"center",flexDirection:"column",justifyContent:"center",background:"transparent",border:"none",cursor:"pointer",marginRight:"1rem"},children:n.jsx("img",{src:ue,style:{height:"3rem"}})})}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"90%",margin:"0 auto",height:`${x}rem`},children:[n.jsx("textarea",{className:"nameInput",type:"text",placeholder:"이름",onChange:ve,value:j,style:{height:`${x}rem`,lineHeight:`${x-1}rem`}}),n.jsx("div",{style:{width:"2rem"}}),n.jsx("textarea",{className:"passwordInput",type:"text",placeholder:"비밀번호(숫자만)",onChange:xe,value:S,style:{height:`${x}rem`,lineHeight:`${x-1}rem`}})]}),n.jsx(B,{height:`${N}rem`}),n.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"90%",margin:"0 auto",height:`${L}rem`},children:n.jsx("textarea",{className:"messageInput",type:"text",placeholder:"메세지를 작성해주세요",onChange:ye,value:C,style:{height:`${L-1}rem`,width:"100%"}})}),n.jsx(B,{height:`${N}rem`}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("div",{className:"button",onClick:W,style:{width:"90%",height:`${x}rem`},children:"전송"})}),n.jsx(B,{height:`${Y}rem`})]})})]})};export{Me as default};
